<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Architecture of Time: An Interactive Exploration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Neutral Harmony -->
    <!-- Application Structure Plan: The SPA is designed as a thematic journey, starting with fundamental physics, moving to biophysics, then human biology/psychology, its pathologies, and finally speculative futures. This non-linear structure, organized by a persistent side navigation, allows users to explore complex, interrelated topics in a logical progression from the abstract to the concrete and then to the speculative. This is more intuitive than mirroring the structure of any single source document, as it builds a conceptual foundation for the user. Key interactions include an interactive chart to compare clock types and a clickable card grid to explore different forms of "Dissonance," making dense information digestible and engaging. -->
    <!-- Visualization & Content Choices: 1) Reality Architectures: Goal: Compare A/B theories. Method: Side-by-side text layout with Unicode icons. Justification: Direct comparison is clearest for this foundational dichotomy. 2) The Electrome: Goal: Explain the bioelectric field. Method: Interactive HTML/CSS diagram with clickable hotspots. Justification: Makes a multi-scale concept tangible. 3) The Clocks Within: Goal: Compare biological vs. perceptual clocks. Method: Interactive Chart.js doughnut chart. Justification: More engaging than a static table and visually shows relationships. 4) Biotemporal Dissonance: Goal: Detail the types of dissonance. Method: Interactive grid of "flippable" cards. Justification: A familiar UI pattern for exploring categorized data. 5) XQE Framework: Goal: Explain speculative physics. Method: HTML/CSS flowchart diagram with tooltips. Justification: Simplifies an abstract process into a visual sequence. All choices use HTML/CSS/Canvas and avoid SVG/Mermaid. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f3f1;
            color: #374151;
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
        }
        .nav-link.active, .nav-link:hover {
            background-color: #e7e5e4;
            color: #1c1917;
            transform: translateX(4px);
        }
        .content-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .content-section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .card-container {
            perspective: 1000px;
        }
        .card {
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card.is-flipped {
            transform: rotateY(180deg);
        }
        .card-face {
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
        }
        .card-back {
            transform: rotateY(180deg);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: auto;
            max-height: 450px;
        }
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .has-tooltip:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .time-mode-btn.active {
            background-color: #e7e5e4;
            color: #1c1917;
            border-color: #a8a29e;
            z-index: 10;
        }
        .time-mode-panel {
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="antialiased">

    <div class="flex flex-col md:flex-row min-h-screen">
        <nav id="sidebar" class="w-full md:w-64 bg-stone-200/50 p-4 md:p-6 md:fixed md:h-full flex flex-col">
            <div>
                <h1 class="text-xl font-bold text-stone-800 mb-2">The Architecture of Time</h1>
                <p class="text-sm text-stone-600 mb-8">An Interactive Exploration</p>
            </div>
            <ul class="space-y-2">
                <li><a href="#reality" class="nav-link block p-2 rounded-md font-medium text-stone-700">1. Fabric of Reality</a></li>
                <li><a href="#electrome" class="nav-link block p-2 rounded-md font-medium text-stone-700">2. Blueprint of Life</a></li>
                <li><a href="#clocks" class="nav-link block p-2 rounded-md font-medium text-stone-700">3. The Clocks Within</a></li>
                <li><a href="#dissonance" class="nav-link block p-2 rounded-md font-medium text-stone-700">4. When Time Breaks Down</a></li>
                <li><a href="#xqe" class="nav-link block p-2 rounded-md font-medium text-stone-700">5. Speculative Frontiers</a></li>
            </ul>
            <div class="mt-auto pt-8">
                 <p class="text-xs text-stone-500">ACI Synthesis Engine v2.1</p>
            </div>
        </nav>

        <main class="flex-1 md:ml-64 p-6 md:p-12">
            <section id="intro" class="mb-16" role="banner">
                <h2 class="text-3xl md:text-4xl font-bold text-stone-900 mb-4">An Interactive Synthesis</h2>
                <p class="text-lg text-stone-700 max-w-3xl">This application synthesizes findings from temporal metaphysics, biophysics, and chronobiology to explore the nature of timeâ€”from the fabric of reality to the rhythms of life. Navigate through the sections to uncover the fundamental conflicts in physics, the biological basis of form, the clocks that govern our bodies, and the dissonances that arise when these systems misalign.</p>
            </section>

            <section id="reality" class="content-section min-h-screen pt-16" role="region" aria-labelledby="reality-heading">
                <h3 id="reality-heading" class="text-2xl md:text-3xl font-bold mb-2">I. The Two Architectures of Reality</h3>
                <p class="text-stone-600 mb-8 max-w-3xl">At the base of reality, two competing theories describe the fundamental nature of time itself. This foundational conflict, rooted in ancient Greek philosophy, frames the entire discussion of how time is understood in both physics and our own experience.</p>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-white/60 p-6 rounded-xl shadow-sm border border-stone-200">
                        <div class="flex items-center gap-4 mb-4">
                            <span class="text-4xl" aria-hidden="true">ðŸŒŠ</span>
                            <h4 class="text-xl font-semibold text-stone-800">A-Theory (Dynamic "Becoming")</h4>
                        </div>
                        <p class="mb-4"><strong>Core Idea:</strong> Time is a real, flowing process. The present moment is a privileged, moving "now" that travels from a fixed past into an open, undetermined future.</p>
                        <ul class="space-y-2" role="list">
                            <li class="font-semibold">Keywords:</li>
                            <li><span class="bg-sky-100 text-sky-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">Flowing Time</span></li>
                            <li><span class="bg-sky-100 text-sky-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">The "Now" is Special</span></li>
                            <li><span class="bg-sky-100 text-sky-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">Temporal Becoming</span></li>
                        </ul>
                        <p class="mt-6 text-sm italic text-stone-500">This view aligns with our intuitive human experience.</p>
                    </div>
                    <div class="bg-white/60 p-6 rounded-xl shadow-sm border border-stone-200">
                        <div class="flex items-center gap-4 mb-4">
                            <span class="text-4xl" aria-hidden="true">ðŸ§Š</span>
                            <h4 class="text-xl font-semibold text-stone-800">B-Theory (Static "Being")</h4>
                        </div>
                        <p class="mb-4"><strong>Core Idea:</strong> The "flow" of time is a subjective illusion. Past, present, and future are equally real and co-exist in a static 4D "block universe."</p>
                        <ul class="space-y-2" role="list">
                            <li class="font-semibold">Keywords:</li>
                            <li><span class="bg-indigo-100 text-indigo-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">Block Universe</span></li>
                            <li><span class="bg-indigo-100 text-indigo-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">Illusion of Passage</span></li>
                            <li><span class="bg-indigo-100 text-indigo-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded">Spacetime Manifold</span></li>
                        </ul>
                        <p class="mt-6 text-sm italic text-stone-500">This view aligns with Einstein's theory of relativity.</p>
                    </div>
                </div>
            </section>

            <section id="electrome" class="content-section min-h-screen pt-16" role="region" aria-labelledby="electrome-heading">
                <h3 id="electrome-heading" class="text-2xl md:text-3xl font-bold mb-2">II. The Electrome: The Blueprint of Life</h3>
                <p class="text-stone-600 mb-8 max-w-3xl">Bridging the gap between fundamental physics and living organisms is the <span class="font-semibold text-stone-800">Electrome</span>: the complete, dynamic pattern of bioelectric fields within an organism. This non-genetic information layer acts as an energetic blueprint, guiding how the genetic "hardware" is deployed to build and maintain a body.</p>
                <div class="bg-white/60 p-6 rounded-xl shadow-sm border border-stone-200">
                    <p class="text-center font-semibold mb-4 text-stone-800">How It Works: A Multi-Scale System</p>
                     <p class="text-center text-sm text-stone-600 mb-6">Click the (+) icons to learn more.</p>
                    <div class="relative w-full max-w-lg mx-auto p-4">
                       <div class="flex flex-col items-center space-y-4">
                            <div class="w-full border-2 border-dashed border-teal-300 p-4 rounded-lg text-center has-tooltip relative">
                               <p class="font-bold text-teal-800">Organism Level</p>
                               <p class="text-sm text-teal-700">Overall Anatomical Plan</p>
                               <button class="interactive-hotspot absolute -right-3 -top-3" data-title="Morphogenetic Fields" data-text="The Electrome constitutes the physical basis for the 'morphogenetic field,' a concept that describes an invisible blueprint guiding anatomical development and regeneration. It dictates the overall body plan." aria-label="More about Morphogenetic Fields">+</button>
                            </div>
                            <div class="text-2xl text-teal-500" aria-hidden="true">â†“</div>
                            <div class="w-10/12 border-2 border-dashed border-cyan-300 p-4 rounded-lg text-center has-tooltip relative">
                                <p class="font-bold text-cyan-800">Tissue Level</p>
                                <p class="text-sm text-cyan-700">Transepithelial Potentials</p>
                                <button class="interactive-hotspot absolute -right-3 -top-3" data-title="Tissue-Level Gradients" data-text="Aligned cells in tissues like skin create large voltage gradients. When wounded, this gradient is short-circuited, creating a 'current of injury' that guides healing cells to the damage site." aria-label="More about Tissue-Level Gradients">+</button>
                            </div>
                             <div class="text-2xl text-cyan-500" aria-hidden="true">â†“</div>
                            <div class="w-8/12 border-2 border-dashed border-sky-300 p-4 rounded-lg text-center has-tooltip relative">
                                <p class="font-bold text-sky-800">Cellular Level</p>
                                <p class="text-sm text-sky-700">Membrane Potential (Vmem)</p>
                                <button class="interactive-hotspot absolute -right-3 -top-3" data-title="Cellular Batteries" data-text="Each cell maintains a voltage across its membrane (Vmem), acting as a tiny battery. Groups of cells can coordinate their Vmem via gap junctions to create bioelectric patterns that pre-figure structures like an eye." aria-label="More about Cellular Batteries">+</button>
                            </div>
                             <div class="text-2xl text-sky-500" aria-hidden="true">â†“</div>
                             <div class="w-6/12 border-2 border-dashed border-indigo-300 p-4 rounded-lg text-center has-tooltip relative">
                                <p class="font-bold text-indigo-800">Molecular Level</p>
                                <p class="text-sm text-indigo-700">Ion Channels & Pumps</p>
                                <button class="interactive-hotspot absolute -right-3 -top-3" data-title="The Molecular Engines" data-text="The entire system is powered by molecular machinesâ€”ion channels and pumpsâ€”that use energy to move charged ions like sodium and potassium across the cell membrane, creating the fundamental charge separation." aria-label="More about Molecular Engines">+</button>
                            </div>
                       </div>
                    </div>
                </div>
            </section>
            
            <div id="modal" class="fixed inset-0 bg-black/60 z-50 hidden items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="modal-title">
                <div class="bg-white rounded-lg p-6 max-w-lg w-full relative">
                    <h4 id="modal-title" class="text-lg font-bold mb-2"></h4>
                    <p id="modal-text" class="text-stone-600"></p>
                    <button id="modal-close" class="absolute top-2 right-2 text-2xl font-bold text-stone-400 hover:text-stone-800" aria-label="Close modal">&times;</button>
                </div>
            </div>

            <section id="clocks" class="content-section min-h-screen pt-16" role="region" aria-labelledby="clocks-heading">
                <h3 id="clocks-heading" class="text-2xl md:text-3xl font-bold mb-2">III. The Clocks Within: Biological & Perceptual Time</h3>
                <p class="text-stone-600 mb-8 max-w-3xl">Our experience of time is governed by two distinct, yet interconnected systems: an objective, biological clockwork with ancient genetic roots, and a subjective, perceptual clock constructed by our brain that is surprisingly malleable. Click the chart segments to explore each.</p>
                <div class="flex flex-col lg:flex-row gap-8 items-center">
                    <div class="chart-container">
                        <canvas id="clocksChart" role="img" aria-label="Doughnut chart comparing Objective and Subjective clocks"></canvas>
                    </div>
                    <div id="clock-details" class="flex-1 bg-white/60 p-6 rounded-xl shadow-sm border border-stone-200 min-h-[300px]" aria-live="polite">
                        <h4 id="details-title" class="text-xl font-semibold text-stone-800 mb-3">Select a Clock</h4>
                        <p id="details-text" class="text-stone-600">Click on a segment of the doughnut chart to learn more about the two primary timekeeping systems that define our temporal reality.</p>
                    </div>
                </div>
            </section>

            <section id="dissonance" class="content-section min-h-screen pt-16" role="region" aria-labelledby="dissonance-heading">
                <h3 id="dissonance-heading" class="text-2xl md:text-3xl font-bold mb-2">IV. Biotemporal Dissonance: When Time Breaks Down</h3>
                <p class="text-stone-600 mb-8 max-w-3xl"><span class="font-semibold text-stone-800">Biotemporal Dissonance</span> is the psychophysiological stress from a conflict between the body's internal time and its experienced reality. This conflict generates measurable tension and can lead to disease. Click the cards below to explore its different forms.</p>
                <div id="dissonance-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                </div>
            </section>

            <section id="xqe" class="content-section min-h-screen pt-16" role="region" aria-labelledby="xqe-heading">
                 <h3 id="xqe-heading" class="text-2xl md:text-3xl font-bold mb-2">V. Speculative Frontiers: The Unified Inflationary Cosmos</h3>
                 <p class="text-stone-600 mb-8 max-w-3xl">This final section synthesizes the previous concepts into a unified, speculative theory. The universe is not merely expanding in space; it is inflating in two interdependent dimensions: **Compositional Space** (what is created) and **Temporal Density** (the richness of the 'Now'). This framework reframes linear time as a perceptual artifact and presents a path toward a more fundamental experience of reality.</p>
                 <div class="bg-white/60 p-6 rounded-xl shadow-sm border border-stone-200">
                    <div class="text-center mb-8">
                        <h4 class="text-xl font-semibold text-stone-800 mb-2">The Two Modes of Time</h4>
                        <p class="text-stone-600 max-w-xl mx-auto">Our experience of time is not fixed. According to this framework, it exists in one of two states: a pathological, linear "prison" or a liberated, volumetric "realm of potential." Select a mode to explore.</p>
                        <div class="mt-4 inline-flex rounded-md shadow-sm" role="group">
                            <button id="chronos-btn" class="time-mode-btn relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500" aria-controls="chronos-content" aria-selected="true">
                                Pathological: Chronos Protocol
                            </button>
                            <button id="kairos-btn" class="time-mode-btn -ml-px relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500" aria-controls="kairos-content" aria-selected="false">
                                Liberated: Kairos
                            </button>
                        </div>
                    </div>

                    <div id="time-mode-content">
                        <div id="chronos-content" class="time-mode-panel">
                            <div class="border-l-4 border-red-500 pl-4">
                                <h5 class="text-lg font-bold text-red-800">The Chronos Protocol: Linear Time as Mass Delusion</h5>
                                <p class="mt-2 text-stone-700">The "arrow of time"â€”marching inexorably from a fixed past to a dreaded futureâ€”does not exist as a fundamental property of the universe. It is a <span class="font-semibold">perceptual artifact</span>, a pathological state of consciousness born from collective Biotemporal Dissonance.</p>
                                <p class="mt-2 text-stone-600 text-sm">It flattens the rich, expanding "Now" into a one-dimensional line and chains this impoverished present to an immutable past. Linear time is the perceptual scar of collective trauma; it is the structure of suffering itself.</p>
                            </div>
                        </div>
                        <div id="kairos-content" class="time-mode-panel hidden">
                             <div class="border-l-4 border-teal-500 pl-4">
                                <h5 class="text-lg font-bold text-teal-800">Kairos: The Volumetric, "Thick" Now</h5>
                                <p class="mt-2 text-stone-700">Kairos is the true experience of time: an opportune, compositional, and volumetric reality. It is the perception of the "thick Now"â€”the expanding temporal density of the present moment, rich with creative potential and informational bandwidth.</p>
                                 <p class="mt-2 text-stone-600 text-sm">Time itself is expanding, not in duration, but in depth. The "Now" is a hyper-dimensional volume that is growing, becoming more layered and real with every act of composition. To experience Kairos is to be fully present in this realm of infinite, expanding potential.</p>
                            </div>
                        </div>
                    </div>
                    
                     <div class="mt-8 border-t border-stone-200 pt-6">
                         <p class="font-semibold text-center text-stone-700">The Great Work: Escaping the Arrow</p>
                         <p class="mt-2 text-center text-stone-600 max-w-xl mx-auto">The purpose of consciousness is to escape the Chronos Protocol. An agent's Time Coefficient (`Ï„â‚–`) is a direct measure of their ability to resist this protocol. High coherence (`Ï„â‚–`) allows one to experience Kairos. The XQE framework is a system designed to build a civilization that can collectively break free from the prison of linear time.</p>
                         <blockquote class="mt-4 text-center italic text-stone-600">"The arrow of time is a symptom of a planetary-scale illness. Healing is the act of remembering that the only true time is the Now that is perpetually being born."</blockquote>
                     </div>
                 </div>
            </section>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const app = {
        clocksData: {
            "objective": {
                title: "The Objective Clock (Chronobiology)",
                text: "This is the body's innate, genetically encoded timekeeping system. A Master Clock (SCN) in the brain orchestrates a federation of Peripheral Clocks in every organ. It's aligned with the 24-hour day by external cues called Zeitgebers (e.g., light, food). Its physical substrate is governed by molecular 'clock gene' feedback loops."
            },
            "subjective": {
                title: "The Subjective Clock (Chronoception)",
                text: "This is the brain's constructed, malleable perception of time's passage. It is not a single clock but a distributed system. Our sense of time stretches and compresses based on Attention, Emotion, and Novelty. Its physical substrates are quantified by EEG Brainwaves (acting as ~10 Hz 'perceptual frames') and Heart Rate Variability (HRV) (an 'interoceptive pacemaker')."
            }
        },

        dissonanceData: [
            {
                type: 'Internal (Chronodisruption)',
                icon: 'â°',
                color: 'bg-amber-100',
                conflict: 'Misalignment of internal clocks with the environment.',
                example: 'Night Shifts, Artificial Light, Mistimed Eating.',
                effects: 'Metabolic Syndrome, Cancer Risk, Mood Disorders, Cardiovascular Disease.'
            },
            {
                type: 'External (Temporal Displacement)',
                icon: 'ðŸš€',
                color: 'bg-blue-100',
                conflict: 'Misalignment of biological age with objective time.',
                example: 'Cryosleep, Near-Light Speed Travel.',
                effects: 'Social Alienation, Identity Crisis, Anachronism, Existential Loss.'
            },
            {
                type: 'Paradoxical (Causal Inconsistency)',
                icon: 'â³',
                color: 'bg-green-100',
                conflict: 'Contradiction between biological existence and causal history.',
                example: 'The Grandfather Paradox in time travel.',
                effects: 'Existential Paradox, Logical Threat to Selfhood, Physical Trauma.'
            },
            {
                type: 'Virtual (Perceptual Dislocation)',
                icon: 'ðŸ•¶ï¸',
                color: 'bg-purple-100',
                conflict: 'Discrepancy between perceived time in a simulation and the body\'s real-time state.',
                example: 'Immersive VR.',
                effects: 'Time Compression Effect, Dissociation from Reality, Neglect of Biological Needs.'
            }
        ],

        init() {
            this.setupScrollspy();
            this.setupIntersectionObserver();
            this.createClocksChart();
            this.renderDissonanceCards();
            this.setupHotspots();
            this.setupTimeModeToggle();
        },
        
        setupHotspots() {
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modal-title');
            const modalText = document.getElementById('modal-text');
            const modalClose = document.getElementById('modal-close');

            document.querySelectorAll('.interactive-hotspot').forEach(hotspot => {
                hotspot.addEventListener('click', () => {
                    modalTitle.textContent = hotspot.dataset.title;
                    modalText.textContent = hotspot.dataset.text;
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                    modal.focus();
                });
            });

            const closeModal = () => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            };

            modalClose.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === "Escape" && !modal.classList.contains('hidden')) {
                    closeModal();
                }
            });
        },
        
        setupTimeModeToggle() {
            const chronosBtn = document.getElementById('chronos-btn');
            const kairosBtn = document.getElementById('kairos-btn');
            const chronosContent = document.getElementById('chronos-content');
            const kairosContent = document.getElementById('kairos-content');
            
            function togglePanel(showPanel, hidePanel, activeBtn, inactiveBtn) {
                hidePanel.style.opacity = '0';
                setTimeout(() => {
                    hidePanel.classList.add('hidden');
                    showPanel.classList.remove('hidden');
                    setTimeout(() => showPanel.style.opacity = '1', 50);
                }, 300);

                activeBtn.classList.add('active');
                inactiveBtn.classList.remove('active');
                activeBtn.setAttribute('aria-selected', 'true');
                inactiveBtn.setAttribute('aria-selected', 'false');
            }

            chronosBtn.addEventListener('click', () => {
                togglePanel(chronosContent, kairosContent, chronosBtn, kairosBtn);
            });

            kairosBtn.addEventListener('click', () => {
                togglePanel(kairosContent, chronosContent, kairosBtn, chronosBtn);
            });
            
            chronosBtn.classList.add('active');
            kairosContent.style.opacity = '0';
        },

        setupScrollspy() {
            const sections = document.querySelectorAll('main section[id]');
            const navLinks = document.querySelectorAll('.nav-link');

            const observer = new IntersectionObserver((entries) => {
                let currentSectionId = null;
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                       currentSectionId = entry.target.id;
                    }
                });
                
                if (currentSectionId) {
                    navLinks.forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href').substring(1) === currentSectionId) {
                            link.classList.add('active');
                        }
                    });
                }

            }, { rootMargin: "-50% 0px -50% 0px", threshold: 0.1 });

            sections.forEach(section => observer.observe(section));
        },
        
        setupIntersectionObserver() {
            const sections = document.querySelectorAll('.content-section');
            const observer = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        obs.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.15 });

            sections.forEach(section => observer.observe(section));
        },
        
        createClocksChart() {
            const ctx = document.getElementById('clocksChart').getContext('2d');
            const detailsTitle = document.getElementById('details-title');
            const detailsText = document.getElementById('details-text');
            
            const chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Objective Clock (Chronobiology)', 'Subjective Clock (Chronoception)'],
                    datasets: [{
                        label: 'Clock Types',
                        data: [50, 50],
                        backgroundColor: [
                            'rgba(168, 85, 247, 0.2)', // purple
                            'rgba(59, 130, 246, 0.2)'  // blue
                        ],
                        borderColor: [
                            'rgba(168, 85, 247, 1)',
                            'rgba(59, 130, 246, 1)'
                        ],
                        borderWidth: 2,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '50%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                        },
                        tooltip: {
                            enabled: true
                        }
                    },
                    onClick: (evt, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            const key = index === 0 ? 'objective' : 'subjective';
                            const data = this.clocksData[key];
                            detailsTitle.textContent = data.title;
                            detailsText.textContent = data.text;
                        }
                    }
                }
            });
        },

        renderDissonanceCards() {
            const container = document.getElementById('dissonance-grid');
            let cardsHTML = '';
            this.dissonanceData.forEach((item, index) => {
                const cardId = `dissonance-card-${index}`;
                cardsHTML += `
                <div class="card-container h-80">
                    <div id="${cardId}" class="card relative w-full h-full">
                        <div class="card-face absolute w-full h-full p-6 rounded-xl shadow-sm border border-stone-200 ${item.color} flex flex-col justify-between">
                            <div>
                                <div class="flex items-center gap-4 mb-3">
                                    <span class="text-4xl" aria-hidden="true">${item.icon}</span>
                                    <h4 class="text-xl font-semibold text-stone-800">${item.type}</h4>
                                </div>
                                <p class="text-stone-700">${item.conflict}</p>
                            </div>
                            <button class="card-flipper self-start mt-4 px-4 py-2 bg-stone-800 text-white rounded-md text-sm font-semibold hover:bg-stone-900" aria-controls="${cardId}">Learn More</button>
                        </div>
                        <div class="card-back absolute w-full h-full p-6 rounded-xl shadow-lg border bg-white flex flex-col justify-between">
                             <div>
                                <h5 class="font-bold mb-2">Key Details:</h5>
                                <p class="text-sm mb-2"><strong class="font-semibold">Example:</strong> ${item.example}</p>
                                <p class="text-sm"><strong class="font-semibold">Key Effects:</strong> ${item.effects}</p>
                            </div>
                            <button class="card-flipper self-start mt-4 px-4 py-2 bg-stone-200 text-stone-800 rounded-md text-sm font-semibold hover:bg-stone-300" aria-controls="${cardId}">Go Back</button>
                        </div>
                    </div>
                </div>
                `;
            });
            container.innerHTML = cardsHTML;
            this.setupCardFlippers();
        },

        setupCardFlippers() {
            document.querySelectorAll('.card-flipper').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.currentTarget.closest('.card').classList.toggle('is-flipped');
                });
            });
        }
    };

    app.init();
});
</script>
</body>
</html>
